import{c as j,j as e,u as g,r as v,t as l,a as b,b as y,g as C}from"./index-BreLnYty.js";import{M as P,d as S}from"./themeToggle-AtNHceHT.js";import{u as w}from"./useQuery-CQbnIkVs.js";import{u as I}from"./useMutation-CVmCXowh.js";import{u as F,c as k,a as q,b as o}from"./index.esm-DwlknhRZ.js";import{A as L,a as R,b as E}from"./avatar-BgL2zWMD.js";import{B as h}from"./button-BoGRaLqt.js";import{C as T,a as V,b as B,c as U,d as $,e as O}from"./card-Cn_5_7Ex.js";import{L as c,I as m}from"./label-BNtE4GZ-.js";import{S as D,a as M,b as _,c as A,d as n}from"./select-CYsHmLeQ.js";import{c as Y}from"./utils-BWD-6FE8.js";import{U as H}from"./user-round-CfNCc40S.js";import{X as K}from"./x-BfLpmtOr.js";import"./dropdown-menu-CDKEkwoc.js";import"./index-Ccf_dzZd.js";import"./index-QR16Epxf.js";import"./Combination-BluQGiSW.js";import"./index-D5v0MlX9.js";import"./check-p4ERIZLp.js";import"./index-cdmIkiA2.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],G=j("camera",z);function J({className:i,...a}){return e.jsx("div",{className:Y("animate-pulse rounded-md bg-muted",i),...a})}const Q=k({firstName:o().required("First Name is required").matches(/^\S*$/,"No spaces are allowed"),lastName:o().required("Last Name is required").matches(/^\S*$/,"No spaces are allowed"),phoneNumber:o().required("Phone Number is required").matches(/^98\d{8}$/,"Invalid phone number"),department:o().required("Department is required"),profilePicture:q().notRequired()});function X(){const i=g({from:"/profileComplete"}),{data:a,isLoading:p,error:f}=w({queryKey:["user"],queryFn:C,staleTime:Number.POSITIVE_INFINITY,gcTime:Number.POSITIVE_INFINITY}),x=I({mutationFn:async s=>{let t="";s.profilePicture&&(t=await b(a.uid,s.profilePicture),s.profilePicture=t),await y(a.uid,s)},onSuccess:()=>{l.success("Profile updated successfully!"),i({to:"/home"})},onError:s=>{l.error(s.message)}}),u=v.useRef(null),N=s=>{var d;const t=(d=s.target.files)==null?void 0:d[0];t&&r.setFieldValue("profilePicture",t)},r=F({initialValues:{firstName:"",lastName:"",phoneNumber:"",department:"",profilePicture:null},validationSchema:Q,onSubmit:s=>{x.mutate(s)}});return e.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[e.jsx("div",{className:"absolute top-0 right-0 p-12",children:e.jsx(P,{})}),e.jsx(T,{className:" mx-auto max-w-md",children:e.jsxs("form",{onSubmit:r.handleSubmit,children:[e.jsxs(V,{children:[e.jsx(B,{children:"Complete Your Profile"}),e.jsx(U,{children:"Provide a few more details to finish setting up your account."})]}),e.jsxs($,{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:N,className:"hidden",ref:u}),e.jsx(L,{className:"h-20 w-20 cursor-pointer",children:p?e.jsx("div",{className:"h-20 w-20 flex items-center justify-center",children:e.jsx(J,{className:"h-20 w-20 rounded-full"})}):f?e.jsx("div",{className:"h-20 w-20 flex items-center justify-center",children:"Error"}):e.jsxs(e.Fragment,{children:[e.jsx(R,{alt:"Profile Picture",src:r.values.profilePicture?URL.createObjectURL(r.values.profilePicture):a==null?void 0:a.photoURL}),e.jsx(E,{children:e.jsx(H,{})})]})}),r.values.profilePicture&&e.jsx("button",{className:"absolute top-0 right-0 -mt-2 -mr-2 h-6 w-6 rounded-full bg-red-500 text-white flex items-center justify-center",onClick:()=>r.setFieldValue("profilePicture",null),children:e.jsx(K,{color:"white",className:"h-4 w-4"})}),e.jsx("div",{onClick:()=>{var s;return(s=u.current)==null?void 0:s.click()},className:"cursor-pointer absolute inset-0 flex items-center justify-center bg-black/50 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(G,{color:"white",className:"h-6 w-6 text-white"})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"first-name",children:"First Name"}),e.jsx(m,{id:"first-name",name:"firstName",placeholder:"John",onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.firstName}),r.touched.firstName&&r.errors.firstName?e.jsx("div",{className:"text-red-500",children:r.errors.firstName}):null]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"last-name",children:"Last Name"}),e.jsx(m,{id:"last-name",name:"lastName",placeholder:"Doe",onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.lastName}),r.touched.lastName&&r.errors.lastName?e.jsx("div",{className:"text-red-500",children:r.errors.lastName}):null]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx(m,{id:"phoneNumber",name:"phoneNumber",placeholder:"+977 9812345678",onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.phoneNumber}),r.touched.phoneNumber&&r.errors.phoneNumber?e.jsx("div",{className:"text-red-500",children:r.errors.phoneNumber}):null]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold text-sm",children:"Department"}),e.jsxs(D,{value:r.values.department,onValueChange:s=>r.setFieldValue("department",s),children:[e.jsx(M,{children:e.jsx(_,{placeholder:"Select Department"})}),e.jsxs(A,{children:[e.jsx(n,{value:"kitchen",children:"Kitchen"}),e.jsx(n,{value:"guest_relations",children:"Guest Relations"}),e.jsx(n,{value:"operations",children:"Operations"}),e.jsx(n,{value:"management",children:"Management"})]})]}),r.touched.department&&r.errors.department?e.jsx("div",{className:"text-red-500",children:r.errors.department}):null]})]}),e.jsxs(O,{children:[e.jsx(h,{type:"button",onClick:async()=>{try{await S()&&i({to:"/"})}catch(s){s instanceof Error?l(`Error signing out: ${s.message}`):l(`Error signing out: ${s}`)}},children:"Logout"}),e.jsx(h,{type:"submit",className:"ml-auto",children:"Finish"})]})]})})]})}const je=X;export{je as component};
