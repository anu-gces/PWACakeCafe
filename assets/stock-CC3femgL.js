import{c as O,r as g,j as e,d as L,q as _,t as q,v as B,w as R}from"./index-Cqcx5OyV.js";import{B as P}from"./button-BfsSAjqZ.js";import{c as V}from"./utils-JbW6ZCj6.js";import{u as Y}from"./useQuery-CorNVHUU.js";import{u as $}from"./useMutation-B-Ddskhk.js";import{S as z}from"./save-MLKjwvvV.js";import{T as C}from"./trash-2-DGqDgkMM.js";import{m as N}from"./proxy-CqjjYnm4.js";import{P as S}from"./plus-Bpq3rAh6.js";import"./SVGVisualElement-BzNYtp1P.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Q=O("grip-vertical",M),T=g.forwardRef(({className:n,...s},r)=>e.jsx("textarea",{className:V("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:r,...s}));T.displayName="Textarea";function G(){const{data:n,isLoading:s,error:r}=Y({queryKey:["kanbanCards"],queryFn:R,staleTime:Number.POSITIVE_INFINITY,gcTime:Number.POSITIVE_INFINITY}),i=L(),[o,a]=g.useState([]);g.useEffect(()=>{n&&a(n)},[n]);const l=$({mutationFn:_,onSuccess:()=>{i.invalidateQueries({queryKey:["kanbanCards"]}),q("Kanban card entered successfully!")}}),f=()=>{l.mutate(o)};return s?e.jsx("div",{className:"flex justify-center items-center w-full h-full",children:e.jsx(B,{className:"animate-spin",size:24})}):r?e.jsxs("div",{className:"flex justify-center items-center w-full h-full",children:["Error: ",r.message,e.jsx("br",{}),"Press F5 to Refresh!"]}):e.jsxs("div",{className:"flex gap-3 bg-muted dark:bg-background shadow-sm p-2 border rounded-lg w-full h-full overflow-auto text-card-foreground",children:[e.jsx(j,{title:"In Stock",column:"inStock",headingColor:"text-blue-500",cards:o,setCards:a}),e.jsx(j,{title:"Running Low",column:"runningLow",headingColor:"text-yellow-500",cards:o,setCards:a}),e.jsx(j,{title:"Out of Stock",column:"outOfStock",headingColor:"text-red-600",cards:o,setCards:a}),e.jsx(j,{title:"Restocked",column:"restocked",headingColor:"text-emerald-400",cards:o,setCards:a}),e.jsxs("div",{className:"flex flex-col gap-6 bg-muted dark:bg-background shadow-sm rounded-lg w-full h-full overflow-hidden text-card-foreground",children:[e.jsxs(P,{className:"inline-flex items-center gap-2 px-4 py-2 rounded focus:outline-none focus-visible:ring-2 focus-visible:ring-primary text-background text-sm transition-opacity duration-500",onClick:f,children:[e.jsx(z,{color:"#ffffff"}),"Save"]}),e.jsx(J,{setCards:a})]})]})}const j=({title:n,headingColor:s,cards:r,column:i,setCards:o})=>{const[a,l]=g.useState(!1),f=(t,c)=>{t.dataTransfer.setData("cardId",c.id)},d=t=>{const c=t.dataTransfer.getData("cardId");l(!1),v();const x=k(),{element:D}=w(t,x),b=D.dataset.before||"-1";if(b!==c){let u=[...r],m=u.find(p=>p.id===c);if(!m)return;if(m={...m,column:i},u=u.filter(p=>p.id!==c),b==="-1")u.push(m);else{const p=u.findIndex(A=>A.id===b);if(p===void 0)return;u.splice(p,0,m)}o(u)}},h=t=>{t.preventDefault(),F(t),l(!0)},v=t=>{(t||k()).forEach(x=>{x.style.opacity="0"})},F=t=>{const c=k();v(c);const x=w(t,c);x.element.style.opacity="1"},w=(t,c)=>c.reduce((b,u)=>{const m=u.getBoundingClientRect(),y=t.clientY-(m.top+50);return y<0&&y>b.offset?{offset:y,element:u}:b},{offset:Number.NEGATIVE_INFINITY,element:c[c.length-1]}),k=()=>Array.from(document.querySelectorAll(`[data-column="${i}"]`)),K=()=>{v(),l(!1)},I=r.filter(t=>t.column===i);return e.jsxs("div",{className:"flex flex-col w-full h-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3 p-2 px-3 border-b-2",children:[e.jsx("h3",{className:`font-medium ${s}`,children:n}),e.jsx("span",{className:"rounded text-neutral-400 text-sm",children:I.length})]}),e.jsxs("div",{onDrop:d,onDragOver:h,onDragLeave:K,className:`h-full w-full p-2 transition-colors rounded ${a?"bg-input/100":"bg-black/0"}`,children:[e.jsx(U,{column:i,setCards:o}),I.map(t=>e.jsx(H,{...t,handleDragStart:f},t.id)),e.jsx(E,{beforeId:null,column:i})]})]})},H=({title:n,id:s,column:r,handleDragStart:i})=>e.jsxs(e.Fragment,{children:[e.jsx(E,{beforeId:s,column:r}),e.jsxs(N.div,{layout:!0,layoutId:s,draggable:"true",onDragStart:o=>i(o,{title:n,id:s,column:r}),className:"flex flex-row gap-2 bg-card shadow-sm p-2 border rounded-lg text-card-foreground cursor-grab active:cursor-grabbing",children:[e.jsx(Q,{color:"#737373",size:24}),e.jsx("p",{children:n})]})]}),E=({beforeId:n,column:s})=>e.jsx("div",{"data-before":n||"-1","data-column":s,className:"bg-primary opacity-0 my-0.5 w-full h-0.5"}),J=({setCards:n})=>{const[s,r]=g.useState(!1),i=l=>{l.preventDefault(),r(!0)},o=()=>{r(!1)},a=l=>{const f=l.dataTransfer.getData("cardId");n(d=>d.filter(h=>h.id!==f)),r(!1)};return e.jsx("div",{onDrop:a,onDragOver:i,onDragLeave:o,className:`grid h-full place-content-center rounded border text-3xl ${s?"border-red-500/50 bg-red-500/50":" bg-background "}`,children:s?e.jsx(C,{className:"animate-ping"}):e.jsx(C,{})})},U=({column:n,setCards:s})=>{const[r,i]=g.useState(""),[o,a]=g.useState(!1),l=d=>{if(d.preventDefault(),!r.trim().length)return;const h={column:n,title:r.trim(),id:Math.random().toString()};s(v=>[...v,h]),a(!1)},f=d=>{d.key==="Enter"?(d.preventDefault(),l(d)):d.key==="Escape"&&a(!1)};return e.jsx(e.Fragment,{children:o?e.jsxs(N.form,{layout:!0,onSubmit:l,children:[e.jsx(T,{onKeyDown:f,onChange:d=>i(d.target.value),autoFocus:!0,placeholder:"Add new item...",className:"rounded w-full"}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"flex justify-end items-center gap-1.5 bg-gray-100 dark:bg-stone-900 mt-1.5 p-1 border border-gray-100 dark:border-0 rounded-lg",children:[e.jsx("button",{onClick:()=>a(!1),className:"inline-flex items-center gap-2 px-4 py-2 rounded focus:outline-none focus-visible:ring-2 focus-visible:ring-primary text-sm transition-opacity duration-500",children:"Close"}),e.jsxs("button",{type:"submit",className:"inline-flex relative justify-center items-center bg-white hover:bg-muted-background dark:bg-background shadow-sm px-4 py-2 rounded focus:outline-none focus-visible:ring-2 focus-visible:ring-primary min-w-24 text-primary hover:text-red-400 dark:text-white text-sm",children:[e.jsx(S,{}),e.jsx("span",{children:"Add"})]})]})})]}):e.jsxs(N.button,{layout:!0,onClick:()=>a(!0),className:"flex items-center gap-1.5 bg-background hover:bg-accent disabled:opacity-50 px-0.5 py-1.5 border border-input rounded-md focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring ring-offset-background focus-visible:ring-offset-2 w-full font-medium text-xs whitespace-nowrap transition-colors text-accent-foreground hover:text-accent-foreground disabled:pointer-events-none",children:[e.jsx(S,{}),e.jsx("span",{children:"Add card"})]})})};function W(){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"h-full  w-full flex flex-col",children:e.jsx(G,{})})})}const ce=W;export{ce as component};
